# WanMap v2 åŒ…æ‹¬çš„å®Ÿè£…çŠ¶æ³ãƒ¬ãƒãƒ¼ãƒˆ

**ç”Ÿæˆæ—¥æ™‚**: 2025-01-16
**å¯¾è±¡**: Phase 1 - Phase 5 å…¨æ©Ÿèƒ½

## ğŸ“Š å®Ÿè£…çŠ¶æ³ã‚µãƒãƒªãƒ¼

### ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ï¼ˆSupabaseï¼‰

| Phase | ã‚«ãƒ†ã‚´ãƒª | çŠ¶æ…‹ | è©³ç´° |
|-------|---------|------|------|
| Phase 1 | åŸºæœ¬ãƒ†ãƒ¼ãƒ–ãƒ« | âš ï¸ éƒ¨åˆ†çš„ | profiles, routes, route_points âœ“ / pins, pin_photos âœ— |
| Phase 2 | ã‚¨ãƒªã‚¢æ©Ÿèƒ½ | âœ… å®Œäº† | areas, official_routes âœ“ |
| Phase 3 | æ¤œç´¢æ©Ÿèƒ½ | â“ ä¸æ˜ | RPCé–¢æ•°ã®å­˜åœ¨ç¢ºèªãŒå¿…è¦ |
| Phase 4 | å±¥æ­´æ©Ÿèƒ½ | âœ… å®Œäº† | trips, trip_routes âœ“ |
| Phase 5 | ã‚½ãƒ¼ã‚·ãƒ£ãƒ« | âœ… å®Œäº† | follows, likes, favorites, notifications âœ“ |
| Phase 5 | ãƒãƒƒã‚¸ | âŒ ä¸å®Œå…¨ | **badges ãƒ†ãƒ¼ãƒ–ãƒ«ãŒå­˜åœ¨ã—ãªã„** / user_badges âœ“ï¼ˆãƒ¬ã‚³ãƒ¼ãƒ‰0ä»¶ï¼‰ |

### Flutter ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³

| Phase | ã‚«ãƒ†ã‚´ãƒª | çŠ¶æ…‹ | è©³ç´° |
|-------|---------|------|------|
| Phase 1 | åŸºæœ¬ç”»é¢ | âœ… å®Œäº† | login, signup, home, map, profile å…¨ã¦ âœ“ |
| Phase 2 | ã‚¨ãƒªã‚¢ç”»é¢ | âš ï¸ éƒ¨åˆ†çš„ | area_list âœ“ / area_detail, official_route âœ— |
| Phase 3 | æ¤œç´¢ç”»é¢ | âŒ æœªå®Ÿè£… | search_screen, search_results_screen âœ— |
| Phase 4 | å±¥æ­´ç”»é¢ | âŒ æœªå®Ÿè£… | history_screen, trip_detail, trip_edit âœ— |
| Phase 5 | ã‚½ãƒ¼ã‚·ãƒ£ãƒ«ç”»é¢ | âœ… å®Œäº† | user_profile, followers, following, notifications âœ“ |
| Phase 5 | ãƒãƒƒã‚¸ç”»é¢ | âš ï¸ éƒ¨åˆ†çš„ | badge_list âœ“ / badge_detail âœ— |
| Phase 5 | çµ±è¨ˆç”»é¢ | âœ… å®Œäº† | statistics_dashboard âœ“ |

### ãƒ¢ãƒ‡ãƒ«ãƒ»ã‚µãƒ¼ãƒ“ã‚¹ãƒ»Provider

| ã‚«ãƒ†ã‚´ãƒª | çŠ¶æ…‹ | è©³ç´° |
|---------|------|------|
| ãƒ¢ãƒ‡ãƒ« | âš ï¸ éƒ¨åˆ†çš„ | badge, route_model, trip_model, notification_model âœ“ / user_model âœ— |
| ã‚µãƒ¼ãƒ“ã‚¹ | âœ… å®Œäº† | auth, route, badge, social, notification å…¨ã¦ âœ“ |
| Provider | âœ… å®Œäº† | auth, route, badge, social, notification å…¨ã¦ âœ“ |

---

## ğŸ” è©³ç´°ãªå•é¡Œç‚¹

### ğŸš¨ ã‚¯ãƒªãƒ†ã‚£ã‚«ãƒ«å•é¡Œï¼ˆå³åº§ã«ä¿®æ­£ãŒå¿…è¦ï¼‰

#### 1. **badges ãƒ†ãƒ¼ãƒ–ãƒ«ãŒå­˜åœ¨ã—ãªã„**
- **å•é¡Œ**: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã« `badges` ãƒ†ãƒ¼ãƒ–ãƒ«ãŒä½œæˆã•ã‚Œã¦ã„ãªã„
- **å½±éŸ¿**: ãƒãƒƒã‚¸ã‚·ã‚¹ãƒ†ãƒ ãŒå®Œå…¨ã«æ©Ÿèƒ½ã—ãªã„
- **åŸå› **: ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³SQLãŒå®Ÿè¡Œã•ã‚Œã¦ã„ãªã„å¯èƒ½æ€§
- **å¯¾ç­–**: `supabase_migrations/008_phase5_badges_system.sql` ã®å†å®Ÿè¡Œ

#### 2. **user_badges ãƒ†ãƒ¼ãƒ–ãƒ«ã«ãƒ¬ã‚³ãƒ¼ãƒ‰ãŒ0ä»¶**
- **å•é¡Œ**: ãƒãƒƒã‚¸è§£é™¤ãƒ¬ã‚³ãƒ¼ãƒ‰ãŒå­˜åœ¨ã—ãªã„
- **å½±éŸ¿**: ãƒãƒƒã‚¸ç”»é¢ãŒç©ºã«ãªã‚‹
- **å¯¾ç­–**: `check_and_unlock_badges` RPCé–¢æ•°ã®å®Ÿè¡Œ

#### 3. **pins / pin_photos ãƒ†ãƒ¼ãƒ–ãƒ«ãŒä¸æ˜**
- **å•é¡Œ**: Phase 1 ã®é‡è¦æ©Ÿèƒ½ã§ã‚ã‚‹ãƒ”ãƒ³æ©Ÿèƒ½ã®ãƒ†ãƒ¼ãƒ–ãƒ«çŠ¶æ…‹ãŒä¸æ˜
- **å½±éŸ¿**: æ•£æ­©ä¸­ã®ãƒ”ãƒ³ä½œæˆæ©Ÿèƒ½ãŒå‹•ä½œã—ãªã„å¯èƒ½æ€§
- **å¯¾ç­–**: ãƒ†ãƒ¼ãƒ–ãƒ«ã®å­˜åœ¨ç¢ºèªã¨å†ä½œæˆ

---

### âš ï¸ é‡è¦å•é¡Œï¼ˆæ©Ÿèƒ½ä¸è¶³ï¼‰

#### Phase 2: ã‚¨ãƒªã‚¢æ©Ÿèƒ½
**ä¸è¶³ç”»é¢:**
- `area_detail_screen.dart` - ã‚¨ãƒªã‚¢è©³ç´°ç”»é¢
- `official_route_screen.dart` - å…¬å¼ãƒ«ãƒ¼ãƒˆè©³ç´°ç”»é¢

**å½±éŸ¿:**
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯ã‚¨ãƒªã‚¢ãƒªã‚¹ãƒˆã‚’è¦‹ã‚‹ã“ã¨ã¯ã§ãã‚‹ãŒã€è©³ç´°ã‚’ç¢ºèªã§ããªã„
- å…¬å¼ãƒ«ãƒ¼ãƒˆã‚’é–²è¦§ãƒ»åˆ©ç”¨ã§ããªã„

#### Phase 3: æ¤œç´¢æ©Ÿèƒ½
**ä¸è¶³ç”»é¢:**
- `search_screen.dart` - æ¤œç´¢ç”»é¢
- `search_results_screen.dart` - æ¤œç´¢çµæœç”»é¢

**å½±éŸ¿:**
- ãƒ«ãƒ¼ãƒˆæ¤œç´¢ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼æ¤œç´¢ãŒå…¨ãã§ããªã„
- ã‚½ãƒ¼ã‚·ãƒ£ãƒ«æ©Ÿèƒ½ã®ç™ºè¦‹æ€§ãŒè‘—ã—ãä½ä¸‹

#### Phase 4: å±¥æ­´æ©Ÿèƒ½
**ä¸è¶³ç”»é¢:**
- `history_screen.dart` - å±¥æ­´ä¸€è¦§ç”»é¢
- `trip_detail_screen.dart` - æ—…è¡Œè©³ç´°ç”»é¢
- `trip_edit_screen.dart` - æ—…è¡Œç·¨é›†ç”»é¢

**å½±éŸ¿:**
- **ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«ã¯trips/trip_routesãƒ†ãƒ¼ãƒ–ãƒ«ãŒå­˜åœ¨ã™ã‚‹ãŒã€UIãŒå…¨ããªã„**
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯è‡ªåˆ†ã®æ•£æ­©å±¥æ­´ã‚’ç¢ºèªã§ããªã„
- æ—…è¡Œæ©Ÿèƒ½ãŒå®Œå…¨ã«ä½¿ç”¨ä¸å¯èƒ½

#### Phase 5: ãƒãƒƒã‚¸æ©Ÿèƒ½
**ä¸è¶³ç”»é¢:**
- `badge_detail_screen.dart` - ãƒãƒƒã‚¸è©³ç´°ç”»é¢

**å½±éŸ¿:**
- ãƒãƒƒã‚¸ã®è©³ç´°æƒ…å ±ã‚’ç¢ºèªã§ããªã„

---

### ğŸ“ ãã®ä»–ã®å•é¡Œ

#### ãƒ¢ãƒ‡ãƒ«
- **user_model.dart ãŒä¸è¶³** - ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã‚’æ‰±ã†ãƒ¢ãƒ‡ãƒ«ãŒå­˜åœ¨ã—ãªã„

---

## ğŸ¯ å„ªå…ˆé †ä½ä»˜ãä¿®æ­£è¨ˆç”»

### ğŸ”´ æœ€å„ªå…ˆï¼ˆPhase 5 ãƒãƒƒã‚¸ã‚·ã‚¹ãƒ†ãƒ ä¿®å¾©ï¼‰

1. **badges ãƒ†ãƒ¼ãƒ–ãƒ«ã®ä½œæˆ**
   ```sql
   -- supabase_migrations/008_phase5_badges_system.sql ã‚’å®Ÿè¡Œ
   ```

2. **ãƒãƒƒã‚¸ãƒ‡ãƒ¼ã‚¿ã®æŠ•å…¥**
   ```sql
   -- 17å€‹ã®ãƒãƒƒã‚¸å®šç¾©ã‚’INSERT
   ```

3. **ãƒ†ã‚¹ãƒˆãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒãƒƒã‚¸è§£é™¤**
   ```sql
   -- test1, test2, test3 ã® check_and_unlock_badges å®Ÿè¡Œ
   ```

### ğŸŸ¡ é«˜å„ªå…ˆï¼ˆPhase 4 å±¥æ­´æ©Ÿèƒ½ã®å®Œå…¨å®Ÿè£…ï¼‰

4. **history_screen.dart ã®ä½œæˆ**
   - trips ãƒ†ãƒ¼ãƒ–ãƒ«ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿å–å¾—
   - ãƒªã‚¹ãƒˆè¡¨ç¤º

5. **trip_detail_screen.dart ã®ä½œæˆ**
   - trip_routes ãƒ†ãƒ¼ãƒ–ãƒ«ã¨çµåˆ
   - è©³ç´°æƒ…å ±è¡¨ç¤º

6. **trip_edit_screen.dart ã®ä½œæˆ**
   - æ—…è¡Œæƒ…å ±ã®ç·¨é›†æ©Ÿèƒ½

### ğŸŸ¢ ä¸­å„ªå…ˆï¼ˆPhase 3 æ¤œç´¢æ©Ÿèƒ½ã®å®Ÿè£…ï¼‰

7. **search_screen.dart ã®ä½œæˆ**
   - æ¤œç´¢å…¥åŠ›UI

8. **search_results_screen.dart ã®ä½œæˆ**
   - search_routes, search_users RPCå‘¼ã³å‡ºã—
   - çµæœè¡¨ç¤º

### ğŸ”µ ä½å„ªå…ˆï¼ˆPhase 2 ã‚¨ãƒªã‚¢è©³ç´°æ©Ÿèƒ½ï¼‰

9. **area_detail_screen.dart ã®ä½œæˆ**
   - ã‚¨ãƒªã‚¢è©³ç´°æƒ…å ±è¡¨ç¤º

10. **official_route_screen.dart ã®ä½œæˆ**
    - å…¬å¼ãƒ«ãƒ¼ãƒˆè©³ç´°ãƒ»åˆ©ç”¨æ©Ÿèƒ½

### ğŸŸ£ ãã®ä»–

11. **badge_detail_screen.dart ã®ä½œæˆ**
    - ãƒãƒƒã‚¸è©³ç´°æƒ…å ±è¡¨ç¤º

12. **user_model.dart ã®ä½œæˆ**
    - ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ãƒ¢ãƒ‡ãƒ«

13. **pins / pin_photos ãƒ†ãƒ¼ãƒ–ãƒ«ã®ç¢ºèªã¨ä¿®å¾©**

---

## ğŸ“Œ ç¾åœ¨ã®ã‚¯ã‚¤ãƒƒã‚¯ã‚¢ã‚¯ã‚·ãƒ§ãƒ³çŠ¶æ³

### daily_walk_view.dart ã®ä¿®æ­£çŠ¶æ³
- âœ… ã‚¯ã‚¤ãƒƒã‚¯ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’è¿½åŠ æ¸ˆã¿
- âœ… ãƒãƒƒã‚¸ãƒœã‚¿ãƒ³ã‚’è¿½åŠ æ¸ˆã¿
- âœ… çµ±è¨ˆãƒœã‚¿ãƒ³ã‚’è¿½åŠ æ¸ˆã¿
- â³ ãƒ›ãƒƒãƒˆãƒªãƒ­ãƒ¼ãƒ‰å¾…ã¡ï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼æ“ä½œãŒå¿…è¦ï¼‰

### æ—¢çŸ¥ã®UIå•é¡Œ
- âŒ ãƒãƒƒã‚¸ãŒè¡¨ç¤ºã•ã‚Œãªã„ï¼ˆbadgesãƒ†ãƒ¼ãƒ–ãƒ«ä¸è¶³ãŒåŸå› ï¼‰
- âŒ Overflowã‚¨ãƒ©ãƒ¼ï¼ˆè©³ç´°èª¿æŸ»ãŒå¿…è¦ï¼‰
- âŒ ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³å¾Œã®ãƒ˜ãƒƒãƒ€ãƒ¼æ¶ˆå¤±ï¼ˆè©³ç´°èª¿æŸ»ãŒå¿…è¦ï¼‰

---

## ğŸš€ æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

### å³åº§ã«å®Ÿè¡Œã™ã¹ãã‚¢ã‚¯ã‚·ãƒ§ãƒ³

1. **badges ãƒ†ãƒ¼ãƒ–ãƒ«ã®ä½œæˆã¨åˆæœŸåŒ–**
   - ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³SQL ã®å®Ÿè¡Œ
   - 17å€‹ã®ãƒãƒƒã‚¸ãƒ‡ãƒ¼ã‚¿ã®æŠ•å…¥
   - ãƒ†ã‚¹ãƒˆãƒ¦ãƒ¼ã‚¶ãƒ¼ã¸ã®ãƒãƒƒã‚¸è§£é™¤

2. **Phase 4 å±¥æ­´ç”»é¢ã®å®Ÿè£…**
   - history_screen.dart
   - trip_detail_screen.dart  
   - trip_edit_screen.dart

3. **Phase 3 æ¤œç´¢ç”»é¢ã®å®Ÿè£…**
   - search_screen.dart
   - search_results_screen.dart

4. **Phase 2 è©³ç´°ç”»é¢ã®å®Ÿè£…**
   - area_detail_screen.dart
   - official_route_screen.dart

5. **UIå•é¡Œã®ä¿®æ­£**
   - Overflowã‚¨ãƒ©ãƒ¼ã®ç‰¹å®šã¨ä¿®æ­£
   - ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³å•é¡Œã®ä¿®æ­£

---

## ğŸ“Š å®Ÿè£…é€²æ—ç‡

| Phase | ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ | Flutter | ç·åˆé€²æ— |
|-------|-------------|---------|----------|
| Phase 1 | 60% | 100% | 80% |
| Phase 2 | 100% | 33% | 67% |
| Phase 3 | â“ | 0% | â“ |
| Phase 4 | 100% | 0% | 50% |
| Phase 5 Social | 100% | 100% | 100% |
| Phase 5 Badge | 0% | 50% | 25% |
| Phase 5 Stats | â“ | 100% | â“ |

**å…¨ä½“é€²æ—**: ç´„ **60%**

---

## ğŸ“ çµè«–

ç¾åœ¨ã®WanMap v2ã¯ã€**Phase 1ã®åŸºæœ¬æ©Ÿèƒ½**ã¨**Phase 5ã®ã‚½ãƒ¼ã‚·ãƒ£ãƒ«æ©Ÿèƒ½**ã¯æ¦‚ã­å®Œæˆã—ã¦ã„ã¾ã™ãŒã€**Phase 3ï¼ˆæ¤œç´¢ï¼‰**ã€**Phase 4ï¼ˆå±¥æ­´ï¼‰**ã€**Phase 5ï¼ˆãƒãƒƒã‚¸ï¼‰**ã«å¤§ããªå®Ÿè£…ä¸è¶³ãŒã‚ã‚Šã¾ã™ã€‚

ç‰¹ã«ã€**badges ãƒ†ãƒ¼ãƒ–ãƒ«ãŒå­˜åœ¨ã—ãªã„**ã¨ã„ã†è‡´å‘½çš„ãªå•é¡Œã«ã‚ˆã‚Šã€ãƒãƒƒã‚¸ã‚·ã‚¹ãƒ†ãƒ ãŒå…¨ãæ©Ÿèƒ½ã—ã¦ã„ã¾ã›ã‚“ã€‚

å„ªå…ˆçš„ã«ä»¥ä¸‹ã‚’å®Ÿæ–½ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ï¼š
1. badges ãƒ†ãƒ¼ãƒ–ãƒ«ã®ä½œæˆã¨åˆæœŸåŒ–
2. Phase 4 å±¥æ­´ç”»é¢ã®å®Œå…¨å®Ÿè£…
3. Phase 3 æ¤œç´¢ç”»é¢ã®å®Ÿè£…
4. UIå•é¡Œï¼ˆOverflowã€ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ï¼‰ã®ä¿®æ­£
