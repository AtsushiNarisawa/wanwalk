# WanMap 実機テスト計画書

## 📱 テスト環境

### 推奨テストデバイス

#### iOS デバイス（最低2台推奨）
- **iPhone 14 Pro Max 以降** (iOS 17.0+)
  - 最新機能のテスト用
  - App Store スクリーンショット取得用
  
- **iPhone SE (第2世代) 以降** (iOS 15.0+)
  - 最小要件での動作確認
  - 小画面での UI 確認

#### Android デバイス（任意、将来対応予定）
- Google Pixel 7 以降
- Samsung Galaxy S23 以降

### テスト条件

- **iOS バージョン**: 15.0 以上
- **ネットワーク**: WiFi、4G/5G、オフライン
- **GPS**: 屋外での実地テスト必須
- **バッテリー**: フル充電および低バッテリー状態

## 🧪 テストケース

### 1. 認証機能テスト

#### 1.1 サインアップ
- [ ] メールアドレスとパスワードで新規登録
- [ ] バリデーションエラーの表示確認
  - [ ] 無効なメールアドレス
  - [ ] 短すぎるパスワード（8文字未満）
- [ ] 登録成功後のホーム画面遷移
- [ ] 確認メールの受信

#### 1.2 ログイン
- [ ] 正しい認証情報でログイン
- [ ] 間違った認証情報でエラー表示
- [ ] パスワードリセット機能
- [ ] ログアウト機能

#### 1.3 セッション管理
- [ ] アプリ再起動後も自動ログイン
- [ ] セッション期限切れ時の再ログイン要求

### 2. GPS 記録機能テスト（最重要）

#### 2.1 基本記録
- [ ] 「散歩を開始」ボタンで記録開始
- [ ] GPS 権限の要求と許可
- [ ] リアルタイムでの位置情報取得
- [ ] マップ上にルートが描画される
- [ ] 距離・時間・速度の表示更新
- [ ] 「終了」ボタンで記録停止

#### 2.2 GPS 精度テスト
- [ ] 直線での記録精度（誤差 10m 以内）
- [ ] カーブでの記録精度
- [ ] 建物の影響（GPS 信号弱い場所）
- [ ] 速度変化の検出（歩行→走行）

#### 2.3 長時間記録
- [ ] 30分以上の連続記録
- [ ] 1時間以上の連続記録
- [ ] バッテリー消費の測定
- [ ] メモリ使用量の確認
- [ ] アプリがクラッシュしないか

#### 2.4 バックグラウンド動作
- [ ] アプリを最小化しても記録継続
- [ ] 画面ロック状態でも記録継続
- [ ] 他のアプリを開いても記録継続
- [ ] 電話着信時の動作
- [ ] 通知が来た時の動作

### 3. オフライン機能テスト（Phase 25）

#### 3.1 オフライン記録
- [ ] 機内モードで散歩記録を開始
- [ ] オフラインバナーの表示確認
- [ ] ローカルに記録が保存される
- [ ] 未同期カウントの表示

#### 3.2 自動同期
- [ ] WiFi に接続したら自動同期開始
- [ ] 同期中のインジケーター表示
- [ ] 同期完了の通知
- [ ] Supabase にデータが正しく保存

#### 3.3 手動同期
- [ ] プロフィール画面の同期ボタン
- [ ] 同期進捗の表示
- [ ] 同期エラー時のリトライ機能

### 4. ルート管理機能テスト

#### 4.1 ルート一覧
- [ ] 自分のルート一覧表示
- [ ] ページネーション動作（20件ずつ）
- [ ] 引っ張って更新（Pull to Refresh）
- [ ] サムネイル画像の表示

#### 4.2 ルート詳細
- [ ] マップ上にルート表示
- [ ] 統計情報の表示（距離、時間、速度）
- [ ] 天気情報の表示
- [ ] 写真ギャラリー
- [ ] コメント一覧

#### 4.3 ルート編集
- [ ] ルート名の編集
- [ ] 説明文の編集
- [ ] 公開/非公開の切り替え
- [ ] ルートの削除

#### 4.4 写真機能
- [ ] カメラで写真撮影
- [ ] ギャラリーから写真選択
- [ ] 複数枚の写真アップロード
- [ ] 写真の削除

### 5. ソーシャル機能テスト（Phase 24）

#### 5.1 フォロー機能
- [ ] ユーザー検索
- [ ] ユーザーをフォロー
- [ ] フォロー解除
- [ ] フォロワー一覧表示
- [ ] フォロー中のユーザー一覧

#### 5.2 いいね機能
- [ ] ルートに「いいね」する
- [ ] 「いいね」を取り消す
- [ ] 「いいね」数の表示
- [ ] 「いいね」したルート一覧

#### 5.3 コメント機能
- [ ] ルートにコメント投稿
- [ ] コメントの編集
- [ ] コメントの削除
- [ ] コメント通知

### 6. プロフィール機能テスト

#### 6.1 プロフィール表示
- [ ] ユーザー情報の表示
- [ ] アバター画像の表示
- [ ] 統計グラフの表示（Phase 21）
  - [ ] 月間距離のグラフ
  - [ ] 週間散歩回数のグラフ

#### 6.2 プロフィール編集
- [ ] 表示名の変更
- [ ] 自己紹介文の編集
- [ ] アバター画像のアップロード
- [ ] 犬の情報（名前、犬種）の編集

### 7. 検索・フィルター機能テスト（Phase 18）

#### 7.1 ルート検索
- [ ] キーワードでルート検索
- [ ] 距離でフィルター（1km未満、1-3km、3-5km、5km以上）
- [ ] 日付でフィルター
- [ ] 自分のルート/全員のルートの切り替え

#### 7.2 ユーザー検索
- [ ] ユーザー名で検索
- [ ] 検索結果からプロフィール表示

### 8. 通知機能テスト（Phase 23）

#### 8.1 通知権限
- [ ] 初回起動時の通知権限要求
- [ ] 設定画面から通知の有効/無効切り替え

#### 8.2 通知内容
- [ ] 散歩リマインダー通知
- [ ] 新しいフォロワー通知
- [ ] いいね通知
- [ ] コメント通知

#### 8.3 通知からの遷移
- [ ] 通知タップで該当画面に遷移
- [ ] アプリが終了していても正しく起動

### 9. UI/UX テスト

#### 9.1 ダークモード（Phase 22）
- [ ] ライトモードで正常表示
- [ ] ダークモードで正常表示
- [ ] システム設定に追従
- [ ] 設定画面からモード切り替え
- [ ] モード切り替え時のアニメーション

#### 9.2 レスポンシブデザイン
- [ ] iPhone SE での表示（小画面）
- [ ] iPhone 14 Pro Max での表示（大画面）
- [ ] 横向き表示の対応
- [ ] タブレット（iPad）での表示

#### 9.3 アニメーション
- [ ] 画面遷移のスムーズさ
- [ ] ボタンタップのフィードバック
- [ ] リスト項目のスワイプアクション

### 10. パフォーマンステスト（Phase 26）

#### 10.1 起動時間
- [ ] コールドスタート（初回起動）: 3秒以内
- [ ] ウォームスタート（2回目以降）: 1秒以内

#### 10.2 画面遷移
- [ ] 各画面の表示: 1秒以内
- [ ] マップ描画: 2秒以内
- [ ] 画像読み込み: 遅延読み込み動作

#### 10.3 メモリ使用量
- [ ] アプリ起動時: 150MB 以下
- [ ] GPS 記録中: 200MB 以下
- [ ] 長時間使用後: メモリリークがない

#### 10.4 バッテリー消費
- [ ] 1時間の GPS 記録: バッテリー消費 15% 以下
- [ ] バックグラウンド時: 最小限の消費

### 11. エラーハンドリングテスト（Phase 27）

#### 11.1 ネットワークエラー
- [ ] オフライン時のエラーメッセージ
- [ ] 接続タイムアウト時の動作
- [ ] 自動リトライ機能
- [ ] リトライボタンの動作

#### 11.2 バリデーションエラー
- [ ] 入力フォームのエラー表示
- [ ] わかりやすいエラーメッセージ
- [ ] エラー箇所へのフォーカス

#### 11.3 権限エラー
- [ ] GPS 権限拒否時のメッセージ
- [ ] カメラ権限拒否時のメッセージ
- [ ] 設定画面への誘導

#### 11.4 サーバーエラー
- [ ] 500 エラー時の表示
- [ ] 認証エラー時のログアウト
- [ ] データ保存失敗時のリトライ

### 12. セキュリティテスト

#### 12.1 認証
- [ ] JWT トークンの有効期限切れ処理
- [ ] セッションハイジャック対策
- [ ] パスワードの暗号化

#### 12.2 データ保護
- [ ] ローカルデータの暗号化（Isar）
- [ ] API 通信の HTTPS 使用
- [ ] 個人情報の適切な管理

#### 12.3 権限管理
- [ ] 他人のデータを編集できない
- [ ] 非公開ルートが他人に見えない
- [ ] 削除したデータが残らない

### 13. 統合テスト

#### 13.1 シナリオ1: 新規ユーザーの初回散歩
1. [ ] アプリをダウンロード
2. [ ] サインアップ
3. [ ] プロフィール設定
4. [ ] 権限を許可
5. [ ] 散歩を記録
6. [ ] 写真を追加
7. [ ] ルートを公開

#### 13.2 シナリオ2: 既存ユーザーの日常利用
1. [ ] アプリを起動（自動ログイン）
2. [ ] 他のユーザーのルートを閲覧
3. [ ] 気に入ったルートに「いいね」
4. [ ] フォロー中のユーザーの新着を確認
5. [ ] 自分の散歩を記録
6. [ ] 統計を確認

#### 13.3 シナリオ3: オフライン利用
1. [ ] 機内モードをオンにする
2. [ ] 散歩を記録
3. [ ] ローカル保存を確認
4. [ ] 機内モードをオフにする
5. [ ] 自動同期を確認

## 🐛 バグ報告フォーマット

バグを発見した場合は、以下の情報を記録してください：

```
【バグ概要】
（簡潔な説明）

【再現手順】
1. ...
2. ...
3. ...

【期待される動作】
（本来どうあるべきか）

【実際の動作】
（実際に何が起きたか）

【環境】
- デバイス: iPhone 14 Pro
- iOS バージョン: 17.1
- アプリバージョン: 1.0.0
- ネットワーク: WiFi/4G/オフライン

【スクリーンショット】
（可能であれば添付）

【その他】
（追加情報）
```

## 📊 テスト結果の記録

### テストチェックシート

| テストケース | 合格/不合格 | 備考 | 担当者 | 日付 |
|------------|-----------|------|--------|------|
| 認証機能 | | | | |
| GPS記録 | | | | |
| オフライン機能 | | | | |
| ... | | | | |

## 🎯 合格基準

### 必須項目（全て合格必要）
- [ ] 認証機能が正常動作
- [ ] GPS 記録が精度 10m 以内
- [ ] オフライン記録と同期が動作
- [ ] 1時間の連続記録でクラッシュしない
- [ ] メモリリークがない
- [ ] セキュリティ脆弱性がない

### 推奨項目（80%以上合格）
- [ ] 全機能の UI が正しく表示
- [ ] パフォーマンス基準を満たす
- [ ] エラーハンドリングが適切
- [ ] ダークモードが正常動作

## 📅 テストスケジュール

### Week 1: 基本機能テスト
- Day 1-2: 認証、GPS記録
- Day 3-4: ルート管理、写真
- Day 5: オフライン機能

### Week 2: 応用機能テスト
- Day 1-2: ソーシャル機能
- Day 3-4: 検索、通知
- Day 5: パフォーマンス

### Week 3: 統合テストとバグ修正
- Day 1-3: 統合テスト、実地テスト
- Day 4-5: バグ修正、再テスト

### Week 4: 最終確認
- Day 1-2: リグレッションテスト
- Day 3: App Store 提出準備
- Day 4: 提出

## 🚀 次のステップ

1. このテスト計画を印刷またはデジタルチェックリストとして使用
2. 実機でテストを開始
3. バグを発見したら Issues に報告
4. 全テストケースが合格したら App Store に提出

**テスト成功を祈っています！🐕**
