# ðŸ“± WanMapé–‹ç™ºå®Ÿè£…æŒ‡ç¤ºæ›¸ v3.0ï¼ˆå®Œå…¨ç‰ˆï¼‰
**Genspark AI DeveloperæŠ•å…¥ç”¨**

**æœ€çµ‚æ›´æ–°æ—¥**: 2025-11-21  
**å¯¾è±¡**: Genspark AI Developer  
**ç›®çš„**: æ„›çŠ¬ã®æ•£æ­©ãƒ«ãƒ¼ãƒˆå…±æœ‰ã‚¢ãƒ—ãƒªã€ŒWanMapã€Phase 1 MVPé–‹ç™º

---

## ðŸš¨ã€æœ€é‡è¦ã€‘æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯å¼·åˆ¶æŒ‡å®š

```
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
âš ï¸ ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯å¿…ãšFlutterã§å®Ÿè£…ã—ã¦ãã ã•ã„ âš ï¸
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ã€å¿…é ˆäº‹é …ã€‘
âœ… Flutter 3.35.7ã‚’ä½¿ç”¨
âœ… ãƒ¢ãƒã‚¤ãƒ«ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆiOS/Androidï¼‰
âœ… Dartè¨€èªžã§å®Ÿè£…

ã€ç¦æ­¢äº‹é …ã€‘
âŒ WebæŠ€è¡“ï¼ˆReact, Vue, Next.js, Honoç­‰ï¼‰ã¯ä½¿ç”¨ã—ãªã„
âŒ Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¨ã—ã¦å®Ÿè£…ã—ãªã„
âŒ Cloudflare Pagesã¯ä½¿ç”¨ã—ãªã„

ã€ç¢ºèªã€‘
ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯ãƒ¢ãƒã‚¤ãƒ«ã‚¢ãƒ—ãƒªã§ã™ã€‚
Flutterãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã§ãƒã‚¤ãƒ†ã‚£ãƒ–ã‚¢ãƒ—ãƒªã‚’é–‹ç™ºã—ã¦ãã ã•ã„ã€‚
```

---

## ðŸŽ¯ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦

### ãƒ“ã‚¸ãƒã‚¹ç›®çš„
1. **ä¸»ç›®çš„**: DogHubï¼ˆç®±æ ¹ã®ãƒ‰ãƒƒã‚°ãƒ›ãƒ†ãƒ«ãƒ»ã‚«ãƒ•ã‚§ï¼‰ã®å®£ä¼ãƒ„ãƒ¼ãƒ«
2. **å‰¯æ¬¡ç›®çš„**: æ—…è¡Œå…ˆã§ã®æ•£æ­©ãƒ«ãƒ¼ãƒˆå…±æœ‰ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ 
3. **å·®åˆ¥åŒ–**: ç«¶åˆ8ã‚¢ãƒ—ãƒªã™ã¹ã¦ãŒæŒãŸãªã„ã€Œãƒ«ãƒ¼ãƒˆå…±æœ‰ã€æ©Ÿèƒ½

### ã‚³ã‚¢ãƒãƒªãƒ¥ãƒ¼
> ã€Œç®±æ ¹ã«æ—…è¡Œã«æ¥ãŸçŠ¬é£¼ã„ä¸»ãŒã€WanMapã‚’é–‹ã„ã¦ã€**5åˆ†ä»¥å†…ã«è‰¯ã•ãã†ãªæ•£æ­©ãƒ«ãƒ¼ãƒˆã‚’è¦‹ã¤ã‘ã¦æ­©ãå§‹ã‚ã‚‰ã‚Œã‚‹**ã€

### Phase 1 MVP ã®ç¯„å›²ï¼ˆ8é€±é–“ï¼‰

âœ… **å®Ÿè£…ã™ã‚‹æ©Ÿèƒ½**
- ã‚²ã‚¹ãƒˆãƒ¢ãƒ¼ãƒ‰ï¼ˆãƒ­ã‚°ã‚¤ãƒ³ãªã—ã§ãƒ«ãƒ¼ãƒˆé–²è¦§å¯èƒ½ï¼‰
- ãƒ¦ãƒ¼ã‚¶ãƒ¼èªè¨¼ï¼ˆãƒ¡ãƒ¼ãƒ«/ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ï¼‰
- çŠ¬æƒ…å ±ç™»éŒ²ï¼ˆè¤‡æ•°é ­å¯¾å¿œï¼‰
- GPSè¨˜éŒ²ï¼ˆãƒ•ã‚©ã‚¢ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ï¼‰
- ãƒ«ãƒ¼ãƒˆä¿å­˜ãƒ»å…±æœ‰ï¼ˆå…¬é–‹/ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆï¼‰
- ãƒ«ãƒ¼ãƒˆæ¤œç´¢ãƒ»é–²è¦§ãƒ»ãƒ•ã‚£ãƒ«ã‚¿
- ã‚ã‚“ã‚¹ãƒãƒƒãƒˆç™»éŒ²ãƒ»é–²è¦§
- ã‚ã‚“ã‚¹ãƒãƒƒãƒˆé‡è¤‡è­¦å‘Š
- å†™çœŸæ’®å½±ãƒ»GPSç´ä»˜ã‘
- DogHubæŽ¨è–¦ãƒãƒƒã‚¸

âŒ **Phase 2ä»¥é™ã«å»¶æœŸ**
- ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰GPSè¨˜éŒ²
- ã‚ã‚“ã‚¹ãƒãƒƒãƒˆè‡ªå‹•çµ±åˆ
- ãƒ’ãƒ¼ãƒˆãƒžãƒƒãƒ—
- ã‚ã‚“ãƒžã‚¤ãƒ«åˆ¶åº¦
- æ—…è¡Œãƒ—ãƒ©ãƒ³æ©Ÿèƒ½
- çµ±è¨ˆæ©Ÿèƒ½
- Instagramé€£æº

---

## ðŸ› ï¸ æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰
- **Flutter**: 3.35.7
- **çŠ¶æ…‹ç®¡ç†**: Provider
- **åœ°å›³**: flutter_map + OpenStreetMapï¼ˆThunderforest ã‚¿ã‚¤ãƒ«ï¼‰
- **GPS**: geolocator + location
- **å†™çœŸ**: image_picker + imageï¼ˆåœ§ç¸®ç”¨ï¼‰

### ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰
- **Supabase**:
  - PostgreSQLï¼ˆPostGISæœ‰åŠ¹åŒ–ï¼‰
  - Authï¼ˆãƒ¡ãƒ¼ãƒ«/ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰èªè¨¼ï¼‰
  - **Storage**ï¼ˆç”»åƒä¿å­˜ - æ—¢ã«å®Ÿè£…æ¸ˆã¿ï¼‰
  - Realtimeï¼ˆãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ›´æ–°ï¼‰

### ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸
- **Supabase Storage**ï¼ˆæ—¢å­˜å®Ÿè£…ã‚’ä½¿ç”¨ï¼‰
  - ãƒã‚±ãƒƒãƒˆ1: `route-photos`ï¼ˆãƒ«ãƒ¼ãƒˆå†™çœŸï¼‰
  - ãƒã‚±ãƒƒãƒˆ2: `profile-avatars`ï¼ˆãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç”»åƒï¼‰
  - **â€»Cloudflare R2ã¯ä½¿ç”¨ã—ã¾ã›ã‚“**

### ã‚¤ãƒ³ãƒ•ãƒ©
- **åœ°å›³ã‚¿ã‚¤ãƒ«**: Thunderforest Outdoorsï¼ˆç„¡æ–™æž ï¼šæœˆ150,000ãƒªã‚¯ã‚¨ã‚¹ãƒˆï¼‰

### ã‚³ã‚¹ãƒˆ
- **å¹´é–“ãƒ©ãƒ³ãƒ‹ãƒ³ã‚°ã‚³ã‚¹ãƒˆ**: Â¥1,200
- **é–‹ç™ºè²»**: ã»ã¼0å††

---

## ðŸ” ç’°å¢ƒå¤‰æ•°è¨­å®š

### ç¾çŠ¶ã®å•é¡Œç‚¹
**âš ï¸ ç¾åœ¨ã€ç’°å¢ƒå¤‰æ•°ãŒ`lib/config/env.dart`ã«ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã•ã‚Œã¦ã„ã¾ã™ã€‚**  
ã“ã‚Œã¯**ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒªã‚¹ã‚¯**ãŒã‚ã‚‹ãŸã‚ã€ä»¥ä¸‹ã®æ‰‹é †ã§å¤–éƒ¨åŒ–ã—ã¦ãã ã•ã„ã€‚

### ã‚¹ãƒ†ãƒƒãƒ—1: `.env`ãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆ

ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒˆã«`.env`ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆï¼š

```env
# Supabase
SUPABASE_URL=https://jkpenklhrlbctebkpvax.supabase.co
SUPABASE_ANON_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...

# Thunderforestï¼ˆåœ°å›³ã‚¿ã‚¤ãƒ«ï¼‰
THUNDERFOREST_API_KEY=xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
```

### ã‚¹ãƒ†ãƒƒãƒ—2: `.gitignore`ã«è¿½åŠ 

```gitignore
# ç’°å¢ƒå¤‰æ•°ï¼ˆæ©Ÿå¯†æƒ…å ±ã‚’å«ã‚€ï¼‰
.env
.env.local
.env.production
```

### ã‚¹ãƒ†ãƒƒãƒ—3: `lib/config/env.dart`ã‚’ä¿®æ­£

**âŒ ç¾åœ¨ã®ã‚³ãƒ¼ãƒ‰ï¼ˆãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ï¼‰**
```dart
class Environment {
  static const String supabaseUrl = 'https://jkpenklhrlbctebkpvax.supabase.co';
  static const String supabaseAnonKey = 'eyJhbGci...';
}
```

**âœ… ä¿®æ­£å¾Œï¼ˆç’°å¢ƒå¤‰æ•°ã‹ã‚‰èª­ã¿è¾¼ã¿ï¼‰**
```dart
class Environment {
  // Supabase
  static const String supabaseUrl = String.fromEnvironment(
    'SUPABASE_URL',
    defaultValue: '',
  );
  
  static const String supabaseAnonKey = String.fromEnvironment(
    'SUPABASE_ANON_KEY',
    defaultValue: '',
  );
  
  // Thunderforest
  static const String thunderforestApiKey = String.fromEnvironment(
    'THUNDERFOREST_API_KEY',
    defaultValue: '',
  );
  
  // ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
  static void validate() {
    if (supabaseUrl.isEmpty || supabaseAnonKey.isEmpty) {
      throw Exception('Supabaseç’°å¢ƒå¤‰æ•°ãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“');
    }
    if (thunderforestApiKey.isEmpty) {
      throw Exception('Thunderforest API Keyç’°å¢ƒå¤‰æ•°ãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“');
    }
  }
}
```

### ã‚¹ãƒ†ãƒƒãƒ—4: ãƒ“ãƒ«ãƒ‰æ™‚ã«ç’°å¢ƒå¤‰æ•°ã‚’æ¸¡ã™

```bash
# .envãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ç’°å¢ƒå¤‰æ•°ã‚’èª­ã¿è¾¼ã‚“ã§ãƒ“ãƒ«ãƒ‰
flutter run --dart-define-from-file=.env
```

---

## ðŸ“Š ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­è¨ˆ

### SupabaseåˆæœŸè¨­å®š

1. **Supabaseãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ**: æ—¢ã«ä½œæˆæ¸ˆã¿
2. **SQL Editorã§ã‚¹ã‚­ãƒ¼ãƒžå®Ÿè¡Œ**: ä»¥ä¸‹ã®å…¨SQLã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®Ÿè¡Œ

```sql
-- ============================================
-- WanMap Database Schema v3.0 (Phase 1 MVP)
-- ============================================

-- PostGISæ‹¡å¼µã‚’æœ‰åŠ¹åŒ–
CREATE EXTENSION IF NOT EXISTS postgis;
CREATE EXTENSION IF NOT EXISTS "uuid-ossp";

-- ============================================
-- 2. user_profilesï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ï¼‰
-- ============================================
CREATE TABLE user_profiles (
  id UUID PRIMARY KEY REFERENCES auth.users(id) ON DELETE CASCADE,
  display_name TEXT NOT NULL,
  avatar_url TEXT,
  bio TEXT,
  is_admin BOOLEAN DEFAULT FALSE,
  business_name TEXT,
  business_location GEOMETRY(POINT, 4326),
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
  updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

ALTER TABLE user_profiles ENABLE ROW LEVEL SECURITY;

CREATE POLICY "Users can view all profiles"
  ON user_profiles FOR SELECT USING (true);

CREATE POLICY "Users can update own profile"
  ON user_profiles FOR UPDATE USING (auth.uid() = id);

CREATE POLICY "Users can insert own profile"
  ON user_profiles FOR INSERT WITH CHECK (auth.uid() = id);

-- ============================================
-- 3. dogsï¼ˆçŠ¬æƒ…å ±ï¼‰
-- ============================================
CREATE TABLE dogs (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  user_id UUID NOT NULL REFERENCES auth.users(id) ON DELETE CASCADE,
  name TEXT NOT NULL,
  breed TEXT,
  size TEXT CHECK (size IN ('small', 'medium', 'large')),
  birth_date DATE,
  weight DECIMAL(5, 2),
  photo_url TEXT,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
  updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

CREATE INDEX idx_dogs_user_id ON dogs(user_id);
ALTER TABLE dogs ENABLE ROW LEVEL SECURITY;

CREATE POLICY "Users can view all dogs"
  ON dogs FOR SELECT USING (true);

CREATE POLICY "Users can manage own dogs"
  ON dogs FOR ALL USING (auth.uid() = user_id);

-- ============================================
-- 4. routesï¼ˆæ•£æ­©ãƒ«ãƒ¼ãƒˆï¼‰
-- ============================================
CREATE TABLE routes (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  user_id UUID NOT NULL REFERENCES auth.users(id) ON DELETE CASCADE,
  dog_id UUID REFERENCES dogs(id) ON DELETE SET NULL,
  title TEXT NOT NULL,
  description TEXT,
  is_public BOOLEAN DEFAULT TRUE,
  distance_meters DECIMAL(10, 2) NOT NULL,
  duration_seconds INTEGER NOT NULL,
  elevation_gain DECIMAL(8, 2),
  difficulty TEXT CHECK (difficulty IN ('easy', 'medium', 'hard')),
  start_location GEOMETRY(POINT, 4326) NOT NULL,
  end_location GEOMETRY(POINT, 4326) NOT NULL,
  area_name TEXT,
  tags TEXT[],
  is_featured BOOLEAN DEFAULT FALSE,
  featured_by UUID REFERENCES auth.users(id),
  featured_comment TEXT,
  view_count INTEGER DEFAULT 0,
  like_count INTEGER DEFAULT 0,
  comment_count INTEGER DEFAULT 0,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
  updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

CREATE INDEX idx_routes_user_id ON routes(user_id);
CREATE INDEX idx_routes_is_public ON routes(is_public);
CREATE INDEX idx_routes_area_name ON routes(area_name);
CREATE INDEX idx_routes_start_location ON routes USING GIST(start_location);
CREATE INDEX idx_routes_tags ON routes USING GIN(tags);

ALTER TABLE routes ENABLE ROW LEVEL SECURITY;

CREATE POLICY "Public routes are viewable by everyone"
  ON routes FOR SELECT USING (is_public = true OR auth.uid() = user_id);

CREATE POLICY "Users can manage own routes"
  ON routes FOR ALL USING (auth.uid() = user_id);

-- ============================================
-- 5. route_pointsï¼ˆãƒ«ãƒ¼ãƒˆåº§æ¨™ç‚¹ï¼‰
-- ============================================
CREATE TABLE route_points (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  route_id UUID NOT NULL REFERENCES routes(id) ON DELETE CASCADE,
  location GEOMETRY(POINT, 4326) NOT NULL,
  altitude DECIMAL(8, 2),
  accuracy DECIMAL(6, 2),
  timestamp TIMESTAMP WITH TIME ZONE NOT NULL,
  sequence_number INTEGER NOT NULL,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

CREATE INDEX idx_route_points_route_id ON route_points(route_id);
CREATE INDEX idx_route_points_sequence ON route_points(route_id, sequence_number);
CREATE INDEX idx_route_points_location ON route_points USING GIST(location);

ALTER TABLE route_points ENABLE ROW LEVEL SECURITY;

CREATE POLICY "Route points inherit route visibility"
  ON route_points FOR SELECT
  USING (
    EXISTS (
      SELECT 1 FROM routes
      WHERE routes.id = route_points.route_id
      AND (routes.is_public = true OR routes.user_id = auth.uid())
    )
  );

CREATE POLICY "Users can manage own route points"
  ON route_points FOR ALL
  USING (
    EXISTS (
      SELECT 1 FROM routes
      WHERE routes.id = route_points.route_id
      AND routes.user_id = auth.uid()
    )
  );

-- ============================================
-- 6. route_photosï¼ˆãƒ«ãƒ¼ãƒˆå†™çœŸï¼‰
-- ============================================
CREATE TABLE route_photos (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  route_id UUID NOT NULL REFERENCES routes(id) ON DELETE CASCADE,
  photo_url TEXT NOT NULL,
  thumbnail_url TEXT,
  storage_path TEXT NOT NULL,
  location GEOMETRY(POINT, 4326),
  caption TEXT,
  taken_at TIMESTAMP WITH TIME ZONE,
  sequence_number INTEGER,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

CREATE INDEX idx_route_photos_route_id ON route_photos(route_id);
ALTER TABLE route_photos ENABLE ROW LEVEL SECURITY;

CREATE POLICY "Route photos inherit route visibility"
  ON route_photos FOR SELECT
  USING (
    EXISTS (
      SELECT 1 FROM routes
      WHERE routes.id = route_photos.route_id
      AND (routes.is_public = true OR routes.user_id = auth.uid())
    )
  );

CREATE POLICY "Users can manage own route photos"
  ON route_photos FOR ALL
  USING (
    EXISTS (
      SELECT 1 FROM routes
      WHERE routes.id = route_photos.route_id
      AND routes.user_id = auth.uid()
    )
  );

-- ============================================
-- 7-12. ãã®ä»–ã®ãƒ†ãƒ¼ãƒ–ãƒ«ï¼ˆroute_likes, route_comments, spots, spot_photos, spot_comments, spot_upvotesï¼‰
-- â€» åŒæ§˜ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã§ä½œæˆ
-- ============================================

-- ============================================
-- PostgreSQL Functionsï¼ˆSupabase RPCç”¨ï¼‰
-- ============================================

CREATE OR REPLACE FUNCTION search_nearby_routes(
  user_lat FLOAT,
  user_lng FLOAT,
  search_radius_km FLOAT DEFAULT 10,
  min_distance_m FLOAT DEFAULT NULL,
  max_distance_m FLOAT DEFAULT NULL,
  difficulty_filter TEXT DEFAULT NULL,
  tags_filter TEXT[] DEFAULT NULL,
  featured_only BOOLEAN DEFAULT FALSE
)
RETURNS TABLE (
  id UUID,
  title TEXT,
  description TEXT,
  distance_meters DECIMAL,
  duration_seconds INTEGER,
  difficulty TEXT,
  area_name TEXT,
  tags TEXT[],
  is_featured BOOLEAN,
  featured_comment TEXT,
  like_count INTEGER,
  comment_count INTEGER,
  view_count INTEGER,
  distance_from_user_meters FLOAT,
  user_display_name TEXT,
  thumbnail_url TEXT,
  created_at TIMESTAMP WITH TIME ZONE
) AS $$
BEGIN
  RETURN QUERY
  SELECT 
    r.id, r.title, r.description, r.distance_meters, r.duration_seconds,
    r.difficulty, r.area_name, r.tags, r.is_featured, r.featured_comment,
    r.like_count, r.comment_count, r.view_count,
    ST_Distance(
      r.start_location::geography,
      ST_SetSRID(ST_MakePoint(user_lng, user_lat), 4326)::geography
    ) as distance_from_user_meters,
    up.display_name as user_display_name,
    (SELECT photo_url FROM route_photos WHERE route_id = r.id ORDER BY sequence_number LIMIT 1) as thumbnail_url,
    r.created_at
  FROM routes r
  JOIN user_profiles up ON r.user_id = up.id
  WHERE r.is_public = true
    AND ST_DWithin(
      r.start_location::geography,
      ST_SetSRID(ST_MakePoint(user_lng, user_lat), 4326)::geography,
      search_radius_km * 1000
    )
    AND (min_distance_m IS NULL OR r.distance_meters >= min_distance_m)
    AND (max_distance_m IS NULL OR r.distance_meters <= max_distance_m)
    AND (difficulty_filter IS NULL OR r.difficulty = difficulty_filter)
    AND (tags_filter IS NULL OR r.tags && tags_filter)
    AND (featured_only = false OR r.is_featured = true)
  ORDER BY 
    CASE WHEN r.is_featured THEN 0 ELSE 1 END,
    distance_from_user_meters ASC;
END;
$$ LANGUAGE plpgsql STABLE;

-- ãƒˆãƒªã‚¬ãƒ¼ã€ãã®ä»–ã®Functionã‚‚åŒæ§˜ã«ä½œæˆ
```

**â€»å®Œå…¨ãªSQLã‚¹ã‚¯ãƒªãƒ—ãƒˆã¯å‰å›žæä¾›ã—ãŸå†…å®¹ã‚’å‚ç…§**

3. **Supabase Storageãƒã‚±ãƒƒãƒˆ**: æ—¢ã«ä½œæˆæ¸ˆã¿
   - `route-photos`
   - `profile-avatars`

---

## ðŸ“¦ pubspec.yaml

```yaml
name: wanmap
description: æ„›çŠ¬ã®æ•£æ­©ãƒ«ãƒ¼ãƒˆå…±æœ‰ã‚¢ãƒ—ãƒª
version: 1.0.0+1

environment:
  sdk: '>=3.0.0 <4.0.0'

dependencies:
  flutter:
    sdk: flutter
  
  supabase_flutter: ^2.5.0
  provider: ^6.1.0
  flutter_map: ^6.1.0
  latlong2: ^0.9.0
  geolocator: ^11.0.0
  location: ^5.0.3
  permission_handler: ^11.0.0
  image_picker: ^1.0.7
  image: ^4.1.7
  dio: ^5.4.0
  http: ^1.2.0
  cached_network_image: ^3.3.1
  shimmer: ^3.0.0
  flutter_rating_bar: ^4.0.1
  photo_view: ^0.14.0
  intl: ^0.18.1
  uuid: ^4.3.0
  path_provider: ^2.1.0
  shared_preferences: ^2.2.0
  collection: ^1.18.0
  logger: ^2.0.0

dev_dependencies:
  flutter_test:
    sdk: flutter
  flutter_lints: ^3.0.0

flutter:
  uses-material-design: true
  assets:
    - assets/images/
    - assets/icons/
```

---

## ðŸ“… é–‹ç™ºãƒ•ã‚§ãƒ¼ã‚ºï¼ˆ8é€±é–“ï¼‰

### Week 1-2: ç’°å¢ƒè¨­å®š + èªè¨¼æ©Ÿèƒ½
- Flutterãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä½œæˆ
- ç’°å¢ƒå¤‰æ•°å¤–éƒ¨åŒ–
- èªè¨¼æ©Ÿèƒ½å®Ÿè£…

### Week 3-4: GPSè¨˜éŒ²æ©Ÿèƒ½
- GPSè¨˜éŒ²å®Ÿè£…
- ãƒ«ãƒ¼ãƒˆä¿å­˜æ©Ÿèƒ½

### Week 5-6: ãƒ«ãƒ¼ãƒˆæ¤œç´¢ãƒ»è¡¨ç¤ºæ©Ÿèƒ½
- ãƒžãƒƒãƒ—ç”»é¢å®Ÿè£…
- ãƒ«ãƒ¼ãƒˆæ¤œç´¢ãƒ»ãƒ•ã‚£ãƒ«ã‚¿

### Week 7: ã‚ã‚“ã‚¹ãƒãƒƒãƒˆæ©Ÿèƒ½
- ã‚ã‚“ã‚¹ãƒãƒƒãƒˆç™»éŒ²
- é‡è¤‡è­¦å‘Šæ©Ÿèƒ½

### Week 8: å†™çœŸæ©Ÿèƒ½ + ãƒ†ã‚¹ãƒˆ
- å†™çœŸã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ï¼ˆæ—¢å­˜å®Ÿè£…æ´»ç”¨ï¼‰
- çµ±åˆãƒ†ã‚¹ãƒˆ

---

## ðŸ”§ ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### GPSæ¨©é™ã‚¨ãƒ©ãƒ¼
iOS: `Info.plist`ã«ä½ç½®æƒ…å ±ä½¿ç”¨èª¬æ˜Žã‚’è¿½åŠ   
Android: `AndroidManifest.xml`ã«æ¨©é™è¿½åŠ 

### åœ°å›³ã‚¿ã‚¤ãƒ«è¡¨ç¤ºã•ã‚Œãªã„
Thunderforest APIã‚­ãƒ¼ã‚’ç¢ºèªã€ç’°å¢ƒå¤‰æ•°ã‚’æ­£ã—ãæ¸¡ã™

### ç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰å¤±æ•—
Supabase Storageãƒã‚±ãƒƒãƒˆã®å­˜åœ¨ã¨Publicè¨­å®šã‚’ç¢ºèª

---

## âœ… ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

### å¿…é ˆæ©Ÿèƒ½
- [ ] ã‚²ã‚¹ãƒˆãƒ¢ãƒ¼ãƒ‰ã§ãƒ«ãƒ¼ãƒˆé–²è¦§
- [ ] GPSè¨˜éŒ²
- [ ] ãƒ«ãƒ¼ãƒˆä¿å­˜ãƒ»æ¤œç´¢
- [ ] ã‚ã‚“ã‚¹ãƒãƒƒãƒˆç™»éŒ²
- [ ] å†™çœŸã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
- [ ] DogHubæŽ¨è–¦ãƒãƒƒã‚¸

### å“è³ªåŸºæº–
- [ ] iOS/Androidå‹•ä½œç¢ºèª
- [ ] GPSç²¾åº¦ãƒ†ã‚¹ãƒˆ
- [ ] ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç¢ºèªï¼ˆRLSï¼‰

---

ã“ã®æŒ‡ç¤ºæ›¸ã‚’Genspark AI Developerã«æŠ•å…¥ã—ã¦ãã ã•ã„ã€‚
