# WanMap - æ„›çŠ¬ã®æ•£æ­©ãƒ«ãƒ¼ãƒˆå…±æœ‰ãƒ¢ãƒã‚¤ãƒ«ã‚¢ãƒ—ãƒª

<div align="center">
  <img src="assets/icon/app_icon.png" width="120" alt="WanMap Icon">
  
  [![Flutter](https://img.shields.io/badge/Flutter-3.38.2-blue.svg)](https://flutter.dev)
  [![Dart](https://img.shields.io/badge/Dart-3.0+-blue.svg)](https://dart.dev)
  [![Supabase](https://img.shields.io/badge/Supabase-PostgreSQL-green.svg)](https://supabase.com)
  [![Riverpod](https://img.shields.io/badge/Riverpod-2.6.1-purple.svg)](https://riverpod.dev)
</div>

## ğŸ“± ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦

WanMapã¯ã€æ„›çŠ¬ã¨ã®æ•£æ­©ã‚’è¨˜éŒ²ãƒ»å…±æœ‰ã§ãã‚‹ãƒ¢ãƒã‚¤ãƒ«ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ã™ã€‚2025å¹´1æœˆã«ãƒªãƒ‹ãƒ¥ãƒ¼ã‚¢ãƒ«ã‚’å®Ÿæ–½ã—ã€2ãƒ¢ãƒ¼ãƒ‰åˆ¶ï¼ˆDaily/Outingï¼‰ã¨å…¬å¼ãƒ«ãƒ¼ãƒˆãƒ»ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£æ©Ÿèƒ½ã‚’å°å…¥ã—ã¾ã—ãŸã€‚

### ğŸ¯ ä¸»ãªæ©Ÿèƒ½

#### 1. **2ãƒ¢ãƒ¼ãƒ‰åˆ¶æ•£æ­©è¨˜éŒ²**
- **Dailyï¼ˆæ—¥å¸¸ã®æ•£æ­©ï¼‰**: ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆè¨˜éŒ²ã¨ã—ã¦ä¿å­˜
- **Outingï¼ˆãŠã§ã‹ã‘æ•£æ­©ï¼‰**: å…¬å¼ãƒ«ãƒ¼ãƒˆã‚’æ­©ã„ã¦ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã«å‚åŠ 

#### 2. **å…¬å¼ãƒ«ãƒ¼ãƒˆã‚·ã‚¹ãƒ†ãƒ **
- ç®¡ç†è€…ãŒç™»éŒ²ã—ãŸæ¨å¥¨ãƒ«ãƒ¼ãƒˆ
- ã‚¨ãƒªã‚¢åˆ¥ã«ãƒ«ãƒ¼ãƒˆã‚’æ¢ç´¢ï¼ˆç®±æ ¹ã€æ¨ªæµœã€éŒå€‰ç­‰ï¼‰
- é›£æ˜“åº¦åˆ¥ï¼ˆåˆç´šãƒ»ä¸­ç´šãƒ»ä¸Šç´šï¼‰
- è·é›¢ãƒ»æ‰€è¦æ™‚é–“è¡¨ç¤º

#### 3. **ãƒ”ãƒ³æŠ•ç¨¿æ©Ÿèƒ½**
- å…¬å¼ãƒ«ãƒ¼ãƒˆä¸Šã«ä½“é¨“ãƒ»ç™ºè¦‹ã‚’æŠ•ç¨¿
- 4ç¨®é¡ã®ãƒ”ãƒ³ã‚¿ã‚¤ãƒ—ï¼ˆæ™¯è‰²/åº—èˆ—/å‡ºä¼šã„/ãã®ä»–ï¼‰
- å†™çœŸæ·»ä»˜ï¼ˆæœ€å¤§5æšï¼‰
- ã„ã„ã­æ©Ÿèƒ½

#### 4. **ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ GPSè¿½è·¡**
- æ•£æ­©ä¸­ã®ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ä½ç½®è¿½è·¡
- çµŒè·¯è¨˜éŒ²ã¨çµ±è¨ˆè¡¨ç¤º
- ä¸€æ™‚åœæ­¢/å†é–‹æ©Ÿèƒ½

## ğŸ—ï¸ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

### æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

| ã‚«ãƒ†ã‚´ãƒª | æŠ€è¡“ | ãƒãƒ¼ã‚¸ãƒ§ãƒ³ |
|---------|------|-----------|
| ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ | Flutter | 3.38.2 |
| è¨€èª | Dart | 3.0+ |
| çŠ¶æ…‹ç®¡ç† | Riverpod | 2.6.1 |
| ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ | Supabase | - |
| ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ | PostgreSQL + PostGIS | - |
| åœ°å›³ | Flutter Map | 6.1.0 |
| GPS | Geolocator | 11.0.0 |

### ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ§‹é€ 

#### ã‚¨ãƒªã‚¢ã¨ãƒ«ãƒ¼ãƒˆ
```
areas (ã‚¨ãƒªã‚¢ãƒã‚¹ã‚¿)
  â”œâ”€â”€ id: UUID
  â”œâ”€â”€ name: TEXT (ç®±æ ¹ã€æ¨ªæµœç­‰)
  â”œâ”€â”€ description: TEXT
  â””â”€â”€ center_location: GEOGRAPHY(Point)

official_routes (å…¬å¼ãƒ«ãƒ¼ãƒˆ)
  â”œâ”€â”€ id: UUID
  â”œâ”€â”€ area_id: UUID â†’ areas
  â”œâ”€â”€ name: TEXT
  â”œâ”€â”€ start_location: GEOGRAPHY(Point)
  â”œâ”€â”€ end_location: GEOGRAPHY(Point)
  â”œâ”€â”€ route_line: GEOGRAPHY(LineString)
  â”œâ”€â”€ distance_meters: FLOAT
  â”œâ”€â”€ estimated_minutes: INT
  â”œâ”€â”€ difficulty_level: TEXT (easy/moderate/hard)
  â””â”€â”€ total_pins: INT
```

#### ãƒ¦ãƒ¼ã‚¶ãƒ¼æŠ•ç¨¿
```
route_pins (ãƒ«ãƒ¼ãƒˆãƒ”ãƒ³)
  â”œâ”€â”€ id: UUID
  â”œâ”€â”€ route_id: UUID â†’ official_routes
  â”œâ”€â”€ user_id: UUID â†’ auth.users
  â”œâ”€â”€ location: GEOGRAPHY(Point)
  â”œâ”€â”€ pin_type: TEXT (scenery/shop/encounter/other)
  â”œâ”€â”€ title: TEXT
  â”œâ”€â”€ comment: TEXT
  â””â”€â”€ likes_count: INT

route_pin_photos (ãƒ”ãƒ³å†™çœŸ)
  â”œâ”€â”€ id: UUID
  â”œâ”€â”€ pin_id: UUID â†’ route_pins
  â”œâ”€â”€ photo_url: TEXT
  â””â”€â”€ sequence_number: INT

pin_likes (ã„ã„ã­)
  â”œâ”€â”€ id: UUID
  â”œâ”€â”€ pin_id: UUID â†’ route_pins
  â”œâ”€â”€ user_id: UUID â†’ auth.users
  â””â”€â”€ created_at: TIMESTAMPTZ
```

#### ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆè¨˜éŒ²
```
daily_walks (æ—¥å¸¸ã®æ•£æ­©)
  â”œâ”€â”€ id: UUID
  â”œâ”€â”€ user_id: UUID â†’ auth.users
  â”œâ”€â”€ walked_at: TIMESTAMPTZ
  â”œâ”€â”€ distance_meters: FLOAT
  â”œâ”€â”€ duration_seconds: INT
  â””â”€â”€ title: TEXT

daily_walk_points (çµŒè·¯ãƒã‚¤ãƒ³ãƒˆ)
  â”œâ”€â”€ id: UUID
  â”œâ”€â”€ route_id: UUID â†’ daily_walks
  â”œâ”€â”€ latitude: FLOAT
  â”œâ”€â”€ longitude: FLOAT
  â”œâ”€â”€ timestamp: TIMESTAMPTZ
  â””â”€â”€ sequence_number: INT
```

## ğŸ“‚ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹é€ 

```
lib/
â”œâ”€â”€ config/                  # è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«
â”‚   â”œâ”€â”€ supabase_config.dart
â”‚   â”œâ”€â”€ wanmap_colors.dart
â”‚   â”œâ”€â”€ wanmap_typography.dart
â”‚   â””â”€â”€ wanmap_spacing.dart
â”‚
â”œâ”€â”€ models/                  # ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«
â”‚   â”œâ”€â”€ walk_mode.dart       # Daily/Outing enum
â”‚   â”œâ”€â”€ area.dart
â”‚   â”œâ”€â”€ official_route.dart  # PostGISå¯¾å¿œ
â”‚   â”œâ”€â”€ route_pin.dart
â”‚   â”œâ”€â”€ route_walk.dart
â”‚   â””â”€â”€ user_walking_profile.dart
â”‚
â”œâ”€â”€ providers/               # RiverpodçŠ¶æ…‹ç®¡ç†
â”‚   â”œâ”€â”€ walk_mode_provider.dart
â”‚   â”œâ”€â”€ area_provider.dart
â”‚   â”œâ”€â”€ official_route_provider.dart
â”‚   â”œâ”€â”€ route_pin_provider.dart
â”‚   â””â”€â”€ gps_provider_riverpod.dart
â”‚
â”œâ”€â”€ screens/                 # ç”»é¢
â”‚   â”œâ”€â”€ home/
â”‚   â”‚   â””â”€â”€ home_screen.dart         # ãƒ›ãƒ¼ãƒ ç”»é¢ï¼ˆãƒ¢ãƒ¼ãƒ‰åˆ‡ã‚Šæ›¿ãˆï¼‰
â”‚   â”œâ”€â”€ daily/
â”‚   â”‚   â””â”€â”€ daily_walk_view.dart     # æ—¥å¸¸ã®æ•£æ­©ç”»é¢
â”‚   â”œâ”€â”€ outing/
â”‚   â”‚   â”œâ”€â”€ outing_walk_view.dart    # ãŠã§ã‹ã‘æ•£æ­©ç”»é¢
â”‚   â”‚   â”œâ”€â”€ area_list_screen.dart    # ã‚¨ãƒªã‚¢ä¸€è¦§
â”‚   â”‚   â”œâ”€â”€ route_list_screen.dart   # ãƒ«ãƒ¼ãƒˆä¸€è¦§
â”‚   â”‚   â”œâ”€â”€ route_detail_screen.dart # ãƒ«ãƒ¼ãƒˆè©³ç´°
â”‚   â”‚   â”œâ”€â”€ walking_screen.dart      # æ•£æ­©ä¸­ç”»é¢
â”‚   â”‚   â””â”€â”€ pin_create_screen.dart   # ãƒ”ãƒ³æŠ•ç¨¿ç”»é¢
â”‚   â””â”€â”€ auth/
â”‚       â”œâ”€â”€ login_screen.dart
â”‚       â””â”€â”€ signup_screen.dart
â”‚
â”œâ”€â”€ widgets/                 # å…±é€šWidget
â”‚   â””â”€â”€ walk_mode_switcher.dart
â”‚
â”œâ”€â”€ services/                # ã‚µãƒ¼ãƒ“ã‚¹ã‚¯ãƒ©ã‚¹
â”‚   â”œâ”€â”€ gps_service.dart
â”‚   â””â”€â”€ notification_service.dart
â”‚
â””â”€â”€ main.dart               # ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆï¼ˆRiverpodå¯¾å¿œï¼‰
```

## ğŸš€ ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

### å‰ææ¡ä»¶

- Flutter 3.38.2ä»¥ä¸Š
- Xcode 26.1.1ï¼ˆiOSé–‹ç™ºã®å ´åˆï¼‰
- Supabaseãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ
- PostGISæœ‰åŠ¹åŒ–æ¸ˆã¿ã®PostgreSQLãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹

### 1. ãƒªãƒã‚¸ãƒˆãƒªã‚¯ãƒ­ãƒ¼ãƒ³

```bash
git clone https://github.com/AtsushiNarisawa/wanmap_v2.git
cd wanmap_v2
```

### 2. ä¾å­˜é–¢ä¿‚ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```bash
flutter pub get
```

### 3. ç’°å¢ƒå¤‰æ•°è¨­å®š

`.env`ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆ:

```env
SUPABASE_URL=your_supabase_url
SUPABASE_ANON_KEY=your_supabase_anon_key
THUNDERFOREST_API_KEY=your_thunderforest_api_key
```

### 4. Supabaseãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œ

Supabaseç®¡ç†ç”»é¢ã®SQLã‚¨ãƒ‡ã‚£ã‚¿ã§ä»¥ä¸‹ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é †æ¬¡å®Ÿè¡Œ:

```bash
supabase_migrations/001_rename_existing_tables.sql
supabase_migrations/002_create_new_tables.sql
supabase_migrations/003_create_rls_policies.sql
supabase_migrations/004_create_rpc_functions.sql
supabase_migrations/005_insert_initial_data.sql
```

### 5. ãƒ“ãƒ«ãƒ‰ã¨å®Ÿè¡Œ

#### ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿
```bash
flutter run
```

#### å®Ÿæ©Ÿï¼ˆiOSï¼‰
```bash
# CocoaPodsä¾å­˜é–¢ä¿‚ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
cd ios
pod install
cd ..

# ãƒ“ãƒ«ãƒ‰ã¨å®Ÿè¡Œ
flutter run --release
```

## ğŸ“Š å®Ÿè£…çŠ¶æ³

### âœ… Phase 1: åŸºæœ¬æ©Ÿèƒ½ï¼ˆå®Œäº†ï¼‰
- [x] ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­è¨ˆï¼ˆPostGISå¯¾å¿œï¼‰
- [x] RLSãƒãƒªã‚·ãƒ¼è¨­å®š
- [x] ãƒ¢ãƒ‡ãƒ«ã‚¯ãƒ©ã‚¹ä½œæˆ
- [x] Riverpod Providerä½œæˆ
- [x] 2ãƒ¢ãƒ¼ãƒ‰åˆ¶UIå®Ÿè£…
- [x] ã‚¨ãƒªã‚¢ãƒ»ãƒ«ãƒ¼ãƒˆç”»é¢å®Ÿè£…
- [x] main.dart Riverpodå¯¾å¿œ

### âœ… Phase 2: ãƒ”ãƒ³æŠ•ç¨¿æ©Ÿèƒ½ï¼ˆå®Œäº†ï¼‰
- [x] ãƒ”ãƒ³ä½œæˆç”»é¢
- [x] å†™çœŸé¸æŠæ©Ÿèƒ½ï¼ˆæœ€å¤§5æšï¼‰
- [x] æ•£æ­©ä¸­ç”»é¢ï¼ˆGPSè¿½è·¡ï¼‰
- [x] ãƒãƒƒãƒ—è¡¨ç¤ºï¼ˆå…¬å¼ãƒ«ãƒ¼ãƒˆé‡ç•³ï¼‰
- [x] çµ±è¨ˆæƒ…å ±è¡¨ç¤º
- [x] ä¸€æ™‚åœæ­¢/å†é–‹æ©Ÿèƒ½
- [x] ãƒ«ãƒ¼ãƒˆè©³ç´°ç”»é¢é€£æº

### â³ Phase 3: å®Œæˆï¼ˆTODOï¼‰
- [ ] å†™çœŸã®Storageã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰å®Ÿè£…
- [ ] GPSçµ±è¨ˆè¨ˆç®—å®Ÿè£…ï¼ˆè·é›¢ãƒ»æ™‚é–“ï¼‰
- [ ] ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«è‡ªå‹•æ›´æ–°
- [ ] å‹•ä½œç¢ºèªã¨ãƒ†ã‚¹ãƒˆ

## ğŸ” ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£

### Row Level Security (RLS)

ã™ã¹ã¦ã®ãƒ†ãƒ¼ãƒ–ãƒ«ã«RLSãƒãƒªã‚·ãƒ¼ãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã™:

- **ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆè¨˜éŒ²**: ãƒ¦ãƒ¼ã‚¶ãƒ¼æœ¬äººã®ã¿ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½
- **å…¬å¼ãƒ«ãƒ¼ãƒˆãƒ»ã‚¨ãƒªã‚¢**: å…¨ãƒ¦ãƒ¼ã‚¶ãƒ¼é–²è¦§å¯èƒ½
- **ãƒ”ãƒ³æŠ•ç¨¿**: å…¨ãƒ¦ãƒ¼ã‚¶ãƒ¼é–²è¦§å¯èƒ½ã€ç·¨é›†ã¯æŠ•ç¨¿è€…ã®ã¿
- **ã„ã„ã­**: å…¨ãƒ¦ãƒ¼ã‚¶ãƒ¼å®Ÿè¡Œå¯èƒ½ã€å‰Šé™¤ã¯æœ¬äººã®ã¿

## ğŸ“± å¯¾å¿œãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ 

- âœ… iOS 12.0ä»¥ä¸Š
- â³ Androidï¼ˆå®Ÿè£…äºˆå®šï¼‰

## ğŸ¤ è²¢çŒ®

ãƒ—ãƒ«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’æ­“è¿ã—ã¾ã™ï¼ä»¥ä¸‹ã®æ‰‹é †ã§ã”å”åŠ›ãã ã•ã„:

1. ãƒ•ã‚©ãƒ¼ã‚¯
2. ãƒ•ã‚£ãƒ¼ãƒãƒ£ãƒ¼ãƒ–ãƒ©ãƒ³ãƒä½œæˆ (`git checkout -b feature/amazing-feature`)
3. ã‚³ãƒŸãƒƒãƒˆ (`git commit -m 'Add amazing feature'`)
4. ãƒ—ãƒƒã‚·ãƒ¥ (`git push origin feature/amazing-feature`)
5. ãƒ—ãƒ«ãƒªã‚¯ã‚¨ã‚¹ãƒˆä½œæˆ

## ğŸ“„ ãƒ©ã‚¤ã‚»ãƒ³ã‚¹

ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯å€‹äººé–‹ç™ºç”¨ã§ã™ã€‚

## ğŸ‘¨â€ğŸ’» é–‹ç™ºè€…

**æˆæ²¢æ•¦å²** (Atsushi Narisawa)
- ãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°ã‚¹ãƒšã‚·ãƒ£ãƒªã‚¹ãƒˆå…¼ãƒšãƒƒãƒˆäº‹æ¥­èµ·æ¥­å®¶
- DogHubï¼ˆç¥å¥ˆå·çœŒè¶³æŸ„ä¸‹éƒ¡ç®±æ ¹ç”ºï¼‰é‹å–¶

## ğŸ“ é€£çµ¡å…ˆ

å•ã„åˆã‚ã›ã¯ GitHub Issues ã§ãŠé¡˜ã„ã—ã¾ã™ã€‚

---

**Last Updated**: 2025-01-22  
**Version**: 1.0.0 (ãƒªãƒ‹ãƒ¥ãƒ¼ã‚¢ãƒ«ç‰ˆ)  
**Git Commits**: 
- Phase 1: 7955650
- Phase 2: 6f50800
